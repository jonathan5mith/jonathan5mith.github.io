<!-- Welcome to the code! ==================================================================== -->

<!-- If you like the project and think you can bring some tech/deisgn skills to the table, tweet me on @jonathan5mith-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" href="https://dl.dropboxusercontent.com/u/10455351/Assets/browser_icon.ico">
    <link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon.png">
    <title>Kick &middot; create</title>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript" ></script>
    <script src="//www.parsecdn.com/js/parse-1.4.0.min.js"></script>
        <script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>


<!-- CSS -->
<!--==============================================-->
    
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/kick.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<!-- Google Fonts -->
<!--==============================================-->

<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Berkshire+Swash' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Londrina+Solid' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,900' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Karla' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lato:300,400,500, 700,900|Merriweather' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Roboto:400,900' rel='stylesheet' type='text/css'>


<!-- Font Awesome -->
<!--==============================================-->

<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  </head>



<!-- Body begins -->
<!--==============================================-->

  <body >
    
<!-- Navbar -->
<!--==============================================-->

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation" data-options="scrolltop: false">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html"> <img src="https://dl.dropboxusercontent.com/u/10455351/Assets/kick%20white%20small2.png"/></a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <!--<li class="active"><a href="index.html">Home</a></li>-->
            <li><a href="http://blog.runwithkick.com">Blog</a></li>
            <li><a href="https://www.strava.com/athletes/jonathansmith" target="_blank" title="Strava"><img src="https://dl.dropboxusercontent.com/u/10455351/Assets/strava1.png"/></a></li>
            <li><a href="http://www.twitter.com/jonathan5mith" target="_blank" title="Twitter"><i class="fa fa-twitter social-icons"></i></a></li>
            <li><a href="https://www.facebook.com/runwithkick" target="_blank" title="Facebook"><i class="fa fa-facebook social-icons"></i></a></li>
            <!--<li><a href="https://www.instagram.com/jonathan5mith" target="_blank" title="Instagram"><i class="fa fa-instagram social-icons"></i></a></li>-->

          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>


<!-- Sub navbar - picture, text container & text-->
<!--==============================================-->
  
  <div class="sub-navbar2">
    <div class="text-container2">
      <p class="line1">Create</p>
    </div> 
</div>

<!-- Main page content-->
<!--==============================================-->


<div class="maincontain"> 
  <div class="formcontain">
    <div class="cardsform">
      <div class="border-bottom">
        <p class="mainheaders" id="removeimage">Make a Kick</p>

      </div>
      <div class="border-below">
       
        <div id="formremove">

        <p>All you need to create a Kick is your Kick ID. Enter it below, push the button and we're off!</p>
          
          <div class="form-group">
            
            <input type="name" class="form-control" id="kickid" placeholder="Kick ID" required>
          </div>

          
          <p style="line-height: 40px;">
            <button type="submit" id="submit" onclick="formSubmit(); " class="btn btn-default">Let's Go!</button>
          </p>

        </div>

        <span id="formconfirm"></span>
        <span id="tweetlink"></span>
       
        

        </div>
      </div>
  </div>
</div>



<!-- Bottom Navbar-->
<!--==============================================-->


<div class="bottomnav">
  
  <p>Â© 2015 Jonathan Smith</p>
</div>





<!-- Parse stuff-->
<!--==============================================-->


<script type="text/javascript">
// Initialisation

function formSubmit() {

Parse.initialize("ImFHWsA4AQ8lDUSfaDlsokY2C6ld3e12bDtfecJ0", "7FynBYH2bC7k3NCvGoKtFsyNw0aTytfvtFo0H2Ei");

var kickid = document.getElementById("kickid").value;

//User database
var personalInfo = Parse.Object.extend("upload1");

//Query
var queryCreate = new Parse.Query(personalInfo);
queryCreate.equalTo("kickId", kickid);
queryCreate.first({
  success: function(object) {
    var twitterhandlex = object.get('TwitterHandle');
    var name = object.get("firstName");
    var entrants = object.get("kickEntrants");
    var kickcount = object.get("kickCount");
    var kickhistory = object.get("runTimes");

    if (kickhistory.length>0){

    if (entrants.length>0){
        var elem = document.getElementById("formremove");
        elem.parentNode.removeChild(elem);
    	var elem = document.getElementById("removeimage");
        elem.parentNode.removeChild(elem);

      	document.getElementById("formconfirm").innerHTML = "<p>It looks like you've already created a Kick this week, head over to your  <a href='http://runwithkick.com/kicks?id="+twitterhandlex+"'>Kick Page to see it</a>.";
    }
    else{

	    object.set("kickEntrants",[twitterhandlex]);
      object.set("kickCount", kickcount+1);
      object.addUnique("kickEntered", twitterhandlex);
	    object.save();
	    var elem = document.getElementById("formremove");
	        elem.parentNode.removeChild(elem);
	    var elem = document.getElementById("removeimage");
	        elem.parentNode.removeChild(elem);
	    document.getElementById("formconfirm").innerHTML = "<p>Congratulations, "+name+" you've created a Kick. Tweet it below and then head over to your  <a href='http://runwithkick.com/kicks?id="+twitterhandlex+"'>Kick Page </a></p>";

      document.getElementById("tweetlink").innerHTML = "<p><a href='https://twitter.com/intent/tweet?text=I've%20just%20made%20a%20kick!&url=http%3A%2F%2Frunwithkick.com%2Fkicks?id="+twitterhandlex+"'> Tweet this Kick!</a></p>"



                    //nested query start
        var queryExplore = new Parse.Query(personalInfo);
        queryExplore.equalTo("kickId", "123A");
        queryExplore.first({
            success: function(object){
             object.addUnique("kickEntrants",twitterhandlex);
             object.save();
            },
            error: function(error){
              alert("something's gone wrong")
            }

        });
        //nested query end
	    
      }
      }
      else{
      var elem = document.getElementById("formremove");
        elem.parentNode.removeChild(elem);
      var elem = document.getElementById("removeimage");
        elem.parentNode.removeChild(elem);

          document.getElementById("formconfirm").innerHTML = "<p>You can't enter a Kick without submitting your first Kick. Head over to your <a href='http://runwithkick.com/profile?id="+twitterhandlex+"'>Profile Page</a> where you can submit your first Kick.</p>";  


      }




    },
  error: function(error) {
    alert("Kick ID not recognised, please check and try again! Email jon@runwithkick.com if the problem persists!");
  }
  }
); 

}

</script>



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

<!--Browser Warning.js-->
<!--==============================================-->

<script> 
var $buoop = {c:2}; 
function $buo_f(){ 
 var e = document.createElement("script"); 
 e.src = "//browser-update.org/update.js"; 
 document.body.appendChild(e);
};
try {document.addEventListener("DOMContentLoaded", $buo_f,false)}
catch(e){window.attachEvent("onload", $buo_f)}
</script> 
	
  </body>
</html>
